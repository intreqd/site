import{j as u}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.BVOCwoKb.js";const G=({glitchColors:p=["#5e4491","#556a9b","#241a38"],glitchSpeed:R=33,centerVignette:T=!1,outerVignette:_=!1,smooth:f=!0})=>{const i=s.useRef(null),h=s.useRef(null),o=s.useRef([]),d=s.useRef({columns:0,rows:0}),l=s.useRef(null),b=s.useRef(Date.now()),$=16,x=10,v=20,M=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","!","@","#","$","&","*","(",")","-","_","+","=","/","[","]","{","}",";",":","<",">",",","0","1","2","3","4","5","6","7","8","9"],C=()=>M[Math.floor(Math.random()*M.length)],g=()=>p[Math.floor(Math.random()*p.length)],P=e=>{const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(n,c,a)=>n+n+c+c+a+a);const r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return r?{r:parseInt(r[1],16),g:parseInt(r[2],16),b:parseInt(r[3],16)}:null},L=(e,t,r)=>{const n={r:Math.round(e.r+(t.r-e.r)*r),g:Math.round(e.g+(t.g-e.g)*r),b:Math.round(e.b+(t.b-e.b)*r)};return`rgb(${n.r}, ${n.g}, ${n.b})`},z=(e,t)=>{const r=Math.ceil(e/x),n=Math.ceil(t/v);return{columns:r,rows:n}},j=(e,t)=>{d.current={columns:e,rows:t};const r=e*t;o.current=Array.from({length:r},()=>({char:C(),color:g(),targetColor:g(),colorProgress:1}))},E=()=>{const e=i.current;if(!e)return;const t=e.parentElement;if(!t)return;const r=window.devicePixelRatio||1,n=t.getBoundingClientRect();e.width=n.width*r,e.height=n.height*r,e.style.width=`${n.width}px`,e.style.height=`${n.height}px`,l.current&&l.current.setTransform(r,0,0,r,0,0);const{columns:c,rows:a}=z(n.width,n.height);j(c,a),m()},m=()=>{if(!l.current||o.current.length===0)return;const e=l.current,{width:t,height:r}=i.current.getBoundingClientRect();e.clearRect(0,0,t,r),e.font=`${$}px monospace`,e.textBaseline="top",o.current.forEach((n,c)=>{const a=c%d.current.columns*x,N=Math.floor(c/d.current.columns)*v;e.fillStyle=n.color,e.fillText(n.char,a,N)})},y=()=>{if(!o.current||o.current.length===0)return;const e=Math.max(1,Math.floor(o.current.length*.05));for(let t=0;t<e;t++){const r=Math.floor(Math.random()*o.current.length);o.current[r]&&(o.current[r].char=C(),o.current[r].targetColor=g(),f?o.current[r].colorProgress=0:(o.current[r].color=o.current[r].targetColor,o.current[r].colorProgress=1))}},A=()=>{let e=!1;o.current.forEach(t=>{if(t.colorProgress<1){t.colorProgress+=.05,t.colorProgress>1&&(t.colorProgress=1);const r=P(t.color),n=P(t.targetColor);r&&n&&(t.color=L(r,n,t.colorProgress),e=!0)}}),e&&m()},w=()=>{const e=Date.now();e-b.current>=R&&(y(),m(),b.current=e),f&&A(),h.current=requestAnimationFrame(w)};return s.useEffect(()=>{const e=i.current;if(!e)return;l.current=e.getContext("2d"),E(),w();let t;const r=()=>{clearTimeout(t),t=setTimeout(()=>{cancelAnimationFrame(h.current),E(),w()},100)};return window.addEventListener("resize",r),()=>{cancelAnimationFrame(h.current),window.removeEventListener("resize",r)}},[R,f]),u.jsxs("div",{className:"relative w-full h-full bg-[#101010] overflow-hidden",children:[u.jsx("canvas",{ref:i,className:"block w-full h-full"}),_&&u.jsx("div",{className:"absolute top-0 left-0 w-full h-full pointer-events-none bg-[radial-gradient(circle,_rgba(16,16,16,0)_60%,_rgba(16,16,16,1)_100%)]"}),T&&u.jsx("div",{className:"absolute top-0 left-0 w-full h-full pointer-events-none bg-[radial-gradient(circle,_rgba(0,0,0,0.8)_0%,_rgba(0,0,0,0)_60%)]"})]})};export{G as default};
